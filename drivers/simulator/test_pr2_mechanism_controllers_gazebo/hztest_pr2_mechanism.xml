<launch>
  <!-- Bring up the node we want to test. -->
  <include file="$(find pr2_gazebo)/pr2_empty.launch"/>

  <!-- load controllers -->
  <param name="base_controller/odom_publish_rate" value="10" />
  <node pkg="mechanism_control" type="spawner.py" args="$(find pr2_default_controllers)/base_controller.xml" output="screen"/>
  <node pkg="mechanism_control" type="spawner.py" args="$(find pr2_default_controllers)/gazebo_head_torso_lift_controller.xml" output="screen"/>
  <node pkg="mechanism_control" type="spawner.py" args="$(find pr2_experimental_controllers)/laser_tilt/laser_tilt_controller.xml" />
  <node pkg="pr2_mechanism_controllers" type="send_laser_traj_cmd_ms2.py" args="laser_tilt_controller" />

  <!-- Run hztest -->
  <!-- Test for publication of 'base_pose_ground_truth' topic. -->
  <test test-name="hztest_test_base_pose_ground_truth" pkg="rostest" type="hztest" time-limit="50" name="base_pose_ground_truth_test">
    <!-- Note how we use a different parameter namespace and node name
    for this test (base_pose_ground_truth_test vs. scan_test). -->
    <param name="topic" value="/base_pose_ground_truth" />
    <param name="hz" value="100.0" />
    <param name="hzerror" value="2.0" />
    <param name="test_duration" value="10.0" />
    <param name="check_intervals" value="false" />
  </test>
  <!-- Test for publication of 'mechanism_state' topic. -->
  <test test-name="hztest_test_mechanism_state" pkg="rostest" type="hztest" time-limit="50" name="mechanism_state_test">
    <!-- Note how we use a different parameter namespace and node name
    for this test (mechanism_state_test vs. scan_test). -->
    <param name="topic" value="/mechanism_state" />
    <param name="hz" value="100.0" />
    <param name="hzerror" value="2.0" />
    <param name="test_duration" value="10.0" />
    <param name="check_intervals" value="false" />
  </test>
  <!-- Test for publication of 'tf_message' topic. -->
  <test test-name="hztest_test_tf_message" pkg="rostest" type="hztest" time-limit="50" name="tf_message_test">
    <!-- Note how we use a different parameter namespace and node name
    for this test (tf_message_test vs. scan_test). -->
    <param name="topic" value="/tf_message" />
    <param name="hz" value="50.0" />
    <param name="hzerror" value="2.0" />
    <param name="test_duration" value="10.0" />
    <param name="check_intervals" value="false" />
  </test>

</launch>
