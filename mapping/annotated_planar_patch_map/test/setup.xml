<launch>

 <include file="$(find annotated_planar_patch_map)/test/stereo.launch" /> 

<node pkg="point_cloud_assembler" type="laser_scan_assembler_srv" output="screen"
      name="laser_scan_assembler">

  <remap from="scan_in" to="tilt_scan"/>
  <param name="tf_cache_time_secs" type="double" value="30.0" />
  <param name="max_scans" type="int" value="4000" />
  <param name="ignore_laser_skew" type="bool" value="true" />
  <param name="fixed_frame" type="string" value="map" />
</node>


   <node pkg="point_cloud_assembler" type="point_cloud_snapshotter" output="screen" name="snapshotter">
    <remap from="laser_scanner_signal" to="laser_tilt_controller/laser_scanner_signal"/>
    <remap from="build_cloud" to="laser_scan_assembler/build_cloud" />
    <remap from="full_cloud" to="snapshot_cloud" />
    <param name="fixed_frame" type="string" value="map" />
    <param name="num_skips" type="int" value="1" />
   </node>

   <node pkg="planar_patch_map" type="planar_patch_map_node"  output="screen">
   	<remap from="/tilt_laser_cloud" to="/snapshot_cloud"/>
   </node>


  <node pkg="annotated_planar_patch_map" type="empty_annotated_map"  
     	name="patch_map_converter" respawn="false" output="screen">

    <param name="description" value="A converter from planar_patch_map to a blank annotated map" />

    <remap from="scan_in" to="/planar_map"/>
    <param name="fixed_frame" value="map"/>
    <remap from="empty_poly_map" to="/patch_maps/empty"/>
    
  </node>	   
<!--	launch-prefix="xterm -e gdb - - args"-->

  <node pkg="annotated_planar_patch_map" type="annotation2d_lifter_to_tagged_patch_map_node" 
     	name="annotation_lifter" respawn="false" output="screen"
	>
    
    <param name="fixed_frame" value="map"/>
    
    <remap from="planar_map" to="/patch_maps/empty"/>
    <remap from="cam_info" to="/stereo/left/cam_info"/>
    
    <param name="~max_extrapolation_distance" value="0.5"/>
    <param name="max_extrapolation_distance" value="0.5"/>
    
    <param name="min_num_indist_tolerance" value="1"/>
    <param name="max_allowed_num_outdist_tolerance" value="0"/>
    <param name="dist_tolerance" value="0.0"/>
    <param name="max_depth" value="5.0"/>
    <param name="min_depth" value="0.1"/>
  </node>	   


</launch>
