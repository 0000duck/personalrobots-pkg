<?xml version="1.0"?>
<root xmlns:sensor="http://playerstage.sourceforge.net/gazebo/xmlschema/#sensor"
      xmlns:controller="http://playerstage.sourceforge.net/gazebo/xmlschema/#controller"
      xmlns:interface="http://playerstage.sourceforge.net/gazebo/xmlschema/#interface">
  
<macro name="prosilica_cam" params="name parent *origin">
  <joint name="${name}_fixed_joint" type="fixed" />
  <link name="${name}_frame">
    <insert_block name="origin" />
    <parent name="${parent}" />
    <joint name="${name}_fixed_joint" />

    <inertial>
      <mass value="0.01" />
      <com xyz="0 0 0" />
      <inertia ixx="0.001"  ixy="0.0"  ixz="0.0"
               iyy="0.001"  iyz="0.0"
               izz="0.001" />
    </inertial>

    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <map name="gazebo_material" flag="gazebo">
        <elem key="material" value="Gazebo/Blue" />
      </map>
      <geometry name="${name}_visual">
        <mesh scale="0.01 0.01 0.01" />
      </geometry>
    </visual>

    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry name="${name}_collision">
        <box size="0.01 0.01 0.01" />
      </geometry>
    </collision>

    <map name="sensor" flag="gazebo">
      <verbatim key="sensor_${name}_camera">
        <sensor:camera name="${name}_sensor">
          <imageWidth>1024</imageWidth>
          <imageHeight>800</imageHeight>
          <hfov>30</hfov>
          <nearClip>0.1</nearClip>
          <farClip>100</farClip>
          <updateRate>20.0</updateRate>
          <controller:ros_camera name="${name}_controller" plugin="libros_camera.so">
            <alwaysOn>true</alwaysOn>
            <updateRate>20.0</updateRate>
            <topicName>${name}/image_raw</topicName>
            <frameName>${name}_link</frameName>
            <interface:camera name="${name}_iface" />
          </controller:ros_camera>
        </sensor:camera>
      </verbatim>
    </map>

  </link>

  <joint name="${name}_optical_fixed_joint" type="fixed" />
  <link name="${name}_optical_frame">
    <parent name="${name}_frame" />
    <joint name="${name}_optical_fixed_joint" />
    <origin xyz="${cal_high_def_x}            ${cal_high_def_y}         ${cal_high_def_z}"
            rpy="${-M_PI/2+cal_high_def_roll} ${0.0+cal_high_def_pitch} ${-M_PI/2+cal_high_def_yaw}" />

    <inertial>
      <mass value="0.01" />
      <com xyz="0 0 0" />
      <inertia ixx="0.001"  ixy="0.0"  ixz="0.0"
               iyy="0.001"  iyz="0.0"
               izz="0.001" />
    </inertial>

    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <map name="gazebo_material" flag="gazebo">
        <elem key="material" value="Gazebo/Blue" />
      </map>
      <geometry name="${name}_optical_visual">
        <mesh scale="0.01 0.01 0.01" />
      </geometry>
    </visual>

    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry name="${name}_optical_collision">
        <box size="0.01 0.01 0.01" />
      </geometry>
    </collision>
  </link>
  
</macro>

</root>
